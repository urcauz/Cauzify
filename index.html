<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="manifest" href="manifest.json">
<!-- PWA Meta Tags -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Cauzify">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0a0a0f">
<link rel="apple-touch-icon" href="icons/icon-192.svg">
<link rel="icon" type="image/svg+xml" sizes="192x192" href="icons/icon-192.svg">
<link rel="icon" type="image/svg+xml" sizes="512x512" href="icons/icon-512.svg">
<title>Cauzify - Music Player</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- â”€â”€â”€ LOGIN SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="screen active" id="login-screen">
  <div class="login-logo">Cauzify</div>
  <div class="login-sub">Mobile Â· Navidrome</div>

  <div class="login-card">
    <div class="field-label">Server URL</div>
    <div class="field-wrap">
      <input type="url" id="server-url" placeholder="http://192.168.1.10:4533" autocomplete="off" autocapitalize="off">
    </div>
    <div class="field-hint">Your Navidrome instance URL</div>

    <div class="field-label">Username</div>
    <div class="field-wrap">
      <input type="text" id="username" placeholder="admin" autocomplete="username">
    </div>

    <div class="field-label">Password</div>
    <div class="field-wrap" style="margin-bottom:24px">
      <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
    </div>

    <button class="btn-primary" id="login-btn" onclick="app.doLogin()">Connect</button>
    <div class="error-msg" id="login-error"></div>
  </div>

  <!-- PWA Install Prompt -->
  <div id="install-prompt" style="display:none; margin-top:20px; text-align:center;">
    <button class="btn-install" onclick="app.installPWA()">ðŸ“± Install App</button>
  </div>

  <!-- Network Status -->
  <div id="network-status" style="display:none; margin-top:20px; text-align:center; color:#f87171; font-size:12px;">
    ðŸ”´ Offline Mode
  </div>
</div>

<!-- â”€â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="screen" id="app-screen">

  <!-- Top Bar -->
  <div class="topbar">
    <div class="topbar-title"><span>Cauzify</span></div>
    <div id="server-badge-wrap" style="display:none">
      <div class="server-badge" id="server-badge">
        <div class="server-badge-dot"></div>
        <span id="server-name-badge">Server</span>
      </div>
    </div>
    <div class="icon-btn" onclick="app.openSettings()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="3"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M4.93 4.93a10 10 0 0 0 0 14.14"/>
        <path d="M12 2v2m0 16v2M2 12h2m16 0h2"/>
      </svg>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs" id="page-tabs">
    <div class="tab active" onclick="app.switchTab('home')">Home</div>
    <div class="tab" onclick="app.switchTab('songs')">Songs</div>
    <div class="tab" onclick="app.switchTab('albums')">Albums</div>
    <div class="tab" onclick="app.switchTab('artists')">Artists</div>
    <div class="tab" onclick="app.switchTab('search')">Search</div>
  </div>

  <!-- Scroll Area -->
  <div class="scroll-area" id="main-scroll">

    <!-- HOME PAGE -->
    <div id="page-home">
      <div id="home-loading" class="loading-spinner">
        <div class="spinner"></div>
        <div class="loading-text">Loading libraryâ€¦</div>
      </div>
      <div id="home-content" style="display:none">
        <div class="section-header">
          <div class="section-title">Recently Added</div>
          <div class="section-more" onclick="app.switchTab('albums')">See all</div>
        </div>
        <div class="album-row" id="recent-albums"></div>

        <div class="section-header" style="margin-top:24px">
          <div class="section-title">Popular Songs</div>
        </div>
        <div id="popular-songs"></div>
      </div>
    </div>

    <!-- SONGS PAGE -->
    <div id="page-songs" style="display:none">
      <div id="songs-loading" class="loading-spinner">
        <div class="spinner"></div>
        <div class="loading-text">Loading songsâ€¦</div>
      </div>
      <div id="songs-list"></div>
    </div>

    <!-- ALBUMS PAGE -->
    <div id="page-albums" style="display:none">
      <div id="albums-loading" class="loading-spinner">
        <div class="spinner"></div>
        <div class="loading-text">Loading albumsâ€¦</div>
      </div>
      <div class="lib-grid" id="albums-grid" style="display:none"></div>
    </div>

    <!-- ARTISTS PAGE -->
    <div id="page-artists" style="display:none">
      <div id="artists-loading" class="loading-spinner">
        <div class="spinner"></div>
        <div class="loading-text">Loading artistsâ€¦</div>
      </div>
      <div id="artists-content" style="display:none">
        <div class="artist-row" id="artists-row"></div>
        <div style="height:16px"></div>
        <div id="artists-alpha"></div>
      </div>
    </div>

    <!-- SEARCH PAGE -->
    <div id="page-search" style="display:none">
      <div class="search-bar">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input type="search" id="search-input" placeholder="Artists, songs, albumsâ€¦" oninput="app.doSearch(this.value)">
      </div>
      <div id="search-results"></div>
    </div>

  </div>

  <!-- Bottom Player Bar -->
  <div class="player-bar hidden" id="player-bar" onclick="app.openPlayer()">
    <div class="player-thumb" id="pbar-thumb">ðŸŽµ</div>
    <div class="player-info">
      <div class="player-title" id="pbar-title">Nothing playing</div>
      <div class="player-artist" id="pbar-artist">â€”</div>
    </div>
    <div class="player-controls" onclick="event.stopPropagation()">
      <button class="ctrl-btn" onclick="app.prevTrack()">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="20" height="20">
          <polygon points="19 20 9 12 19 4 19 20"/><line x1="5" y1="19" x2="5" y2="5"/>
        </svg>
      </button>
      <button class="ctrl-btn play-btn" id="pbar-play" onclick="app.togglePlay()">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="20" height="20" id="pbar-play-icon">
          <polygon points="5 3 19 12 5 21 5 3"/>
        </svg>
      </button>
      <button class="ctrl-btn" onclick="app.nextTrack()">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="20" height="20">
          <polygon points="5 4 15 12 5 20 5 4"/><line x1="19" y1="5" x2="19" y2="19"/>
        </svg>
      </button>
    </div>
    <div class="player-progress"><div class="player-progress-fill" id="pbar-prog"></div></div>
  </div>

  <!-- Bottom Nav -->
  <div class="bottom-nav">
    <div class="nav-item active" id="nav-library" onclick="app.showNav('library')">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
      <span>Library</span>
    </div>
    <div class="nav-item" id="nav-queue" onclick="app.toggleQueue()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
      <span>Queue</span>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ FULL PLAYER SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="screen" id="player-screen">
  <div class="pull-bar">
    <div class="drag-handle" onclick="app.closePlayer()"></div>
  </div>
  <div class="player-full-art" id="pfull-art">
    <div class="player-full-art-placeholder" id="pfull-art-placeholder">ðŸŽµ</div>
    <img id="pfull-art-img" src="" style="display:none; position:absolute;inset:0; width:100%; height:100%; object-fit:cover" alt="Album art">
  </div>

  <div class="player-full-meta">
    <div class="player-full-info">
      <div class="player-full-title" id="pfull-title">â€”</div>
      <div class="player-full-artist" id="pfull-artist">â€”</div>
    </div>
    <div class="icon-btn fav-btn" id="fav-btn" onclick="app.toggleFav()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="22" height="22">
        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
      </svg>
    </div>
  </div>

  <div class="player-full-seek">
    <div class="seek-bar" id="seek-bar" onclick="app.seekTo(event)">
      <div class="seek-fill" id="seek-fill"></div>
    </div>
    <div class="seek-times">
      <span id="seek-cur">0:00</span>
      <span id="seek-dur">0:00</span>
    </div>
  </div>

  <div class="player-full-controls">
    <button class="fc-btn" id="shuffle-btn" onclick="app.toggleShuffle()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="22" height="22">
        <polyline points="16 3 21 3 21 8"/><line x1="4" y1="20" x2="21" y2="3"/>
        <polyline points="21 16 21 21 16 21"/><line x1="15" y1="15" x2="21" y2="21"/>
        <line x1="4" y1="4" x2="9" y2="9"/>
      </svg>
    </button>
    <button class="fc-btn" onclick="app.prevTrack()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="28" height="28">
        <polygon points="19 20 9 12 19 4 19 20"/><line x1="5" y1="19" x2="5" y2="5"/>
      </svg>
    </button>
    <button class="fc-play-btn" id="pfull-play" onclick="app.togglePlay()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="28" height="28" id="pfull-play-icon">
        <polygon points="5 3 19 12 5 21 5 3"/>
      </svg>
    </button>
    <button class="fc-btn" onclick="app.nextTrack()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="28" height="28">
        <polygon points="5 4 15 12 5 20 5 4"/><line x1="19" y1="5" x2="19" y2="19"/>
      </svg>
    </button>
    <button class="fc-btn" id="repeat-btn" onclick="app.toggleRepeat()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="22" height="22">
        <polyline points="17 1 21 5 17 9"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/>
        <polyline points="7 23 3 19 7 15"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/>
      </svg>
    </button>
  </div>

  <div class="player-full-volume">
    <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/></svg>
    <div class="vol-bar" id="vol-bar" onclick="app.setVolume(event)">
      <div class="vol-fill" id="vol-fill"></div>
    </div>
    <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
  </div>
</div>

<!-- â”€â”€â”€ SETTINGS SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="screen" id="settings-screen">
  <div class="settings-header">
    <div class="back-btn" onclick="app.closeSettings()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
    </div>
    <div style="font-size:18px;font-weight:800">Settings</div>
  </div>
  <div class="settings-scroll">
    <div class="settings-section">
      <div class="settings-section-title">Server</div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Server URL</div>
          <div class="settings-item-sub" id="settings-server-url">â€”</div>
        </div>
      </div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Username</div>
          <div class="settings-item-sub" id="settings-username">â€”</div>
        </div>
      </div>
      <div class="settings-item" style="cursor:pointer" onclick="app.disconnect()">
        <div class="settings-item-info">
          <div class="settings-item-title" style="color:var(--danger)">Disconnect</div>
          <div class="settings-item-sub">Log out and change server</div>
        </div>
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="18" height="18" style="stroke:var(--text3)">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">Playback</div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Gapless Playback</div>
          <div class="settings-item-sub">Seamlessly transition between tracks</div>
        </div>
        <div class="toggle on" id="toggle-gapless" onclick="this.classList.toggle('on')"></div>
      </div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Scrobble to Last.fm</div>
          <div class="settings-item-sub">via Navidrome integration</div>
        </div>
        <div class="toggle" id="toggle-scrobble" onclick="this.classList.toggle('on')"></div>
      </div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Audio Quality</div>
          <div class="settings-item-sub">Stream at max quality</div>
        </div>
        <div class="settings-item-val">Original</div>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">Library</div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title" id="settings-stats">â€”</div>
          <div class="settings-item-sub">Library contents</div>
        </div>
      </div>
      <div class="settings-item" style="cursor:pointer" onclick="app.refreshLib()">
        <div class="settings-item-info">
          <div class="settings-item-title">Refresh Library</div>
          <div class="settings-item-sub">Reload from server</div>
        </div>
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="18" height="18" style="stroke:var(--text3)">
          <polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
        </svg>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">PWA</div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Cache Status</div>
          <div class="settings-item-sub" id="cache-status">Checkingâ€¦</div>
        </div>
      </div>
      <div class="settings-item" style="cursor:pointer" onclick="app.clearCache()">
        <div class="settings-item-info">
          <div class="settings-item-title">Clear Cache</div>
          <div class="settings-item-sub">Remove offline data</div>
        </div>
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="18" height="18" style="stroke:var(--text3)">
          <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">About</div>
      <div class="settings-item">
        <div class="settings-item-info">
          <div class="settings-item-title">Cauzify Mobile</div>
          <div class="settings-item-sub">v1.0 Â· Navidrome PWA client</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Queue Panel -->
<div class="queue-panel" id="queue-panel">
  <div class="queue-panel-header">
    <div class="queue-panel-title">Queue</div>
    <div class="icon-btn" onclick="app.toggleQueue()">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="18" height="18"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </div>
  </div>
  <div class="queue-panel-body" id="queue-body"></div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Backdrop -->
<div id="queue-backdrop" style="position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:399;display:none" onclick="app.toggleQueue()"></div>

<audio id="audio-el"></audio>

<script src="app.js"></script>
</body>
</html>
